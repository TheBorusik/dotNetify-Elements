!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("React"),require("dotnetify")):"function"==typeof define&&define.amd?define(["React","dotnetify"],e):"object"==typeof exports?exports.Form=e(require("React"),require("dotnetify")):t.Form=e(t.React,t.dotnetify)}(window,function(__WEBPACK_EXTERNAL_MODULE__0__,__WEBPACK_EXTERNAL_MODULE__73__){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=289)}({0:function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__0__},14:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function _defineProperty(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _toConsumableArray(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var WebComponentHelper=function(){function WebComponentHelper(t){_classCallCheck(this,WebComponentHelper),this.host=t,this.host.__eventHandlers={}}return _createClass(WebComponentHelper,[{key:"convertAttributeToProp",value:function(t,e,n){var r=Object.keys(t).find(function(t){return t.toLowerCase()==e}),o=n;return"true"===n||"false"===n?o="true"==n:isNaN(n)||""===n?/^{.*}/.exec(n)?o=JSON.parse(n):/([A-z0-9$_]*)\(.*\)/.exec(n)&&(o=this.parseFunctionString(n)):o=+n,"function"==typeof o&&(this.host.__eventHandlers[e]=o),{name:r||e,value:o}}},{key:"getProps",value:function(t,e){var n=this;return e=e||{},[].concat(_toConsumableArray(t)).map(function(t){return n.convertAttributeToProp(e,t.name,t.value)}).reduce(function(t,e){return _extends({},t,_defineProperty({},e.name,e.value))},{})}},{key:"getEvents",value:function(t){var e=this;return Object.keys(t).filter(function(t){return/on([A-Z].*)/.exec(t)}).reduce(function(t,n){return _extends({},t,_defineProperty({},n,function(t){var r=n.toLowerCase(),o=e.host.__eventHandlers[r],i="function"==typeof o?o(t):null;return e.host.dispatchEvent(new CustomEvent(n,_extends({},t))),i}))},{})}},{key:"parseFunctionString",value:function parseFunctionString(funcString){return funcString?function(args){var match=/([A-z0-9$_]*)\(?\)?/.exec(funcString),fnName=match?match[1]:funcString;return"function"!==fnName&&"function"==typeof window[fnName]?window[fnName](args):eval("("+funcString+")")(args)}:null}}]),WebComponentHelper}();exports.default=WebComponentHelper},2:function(t,e,n){t.exports=n(31)()},23:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),u=n(73),a=(r=u)&&r.__esModule?r:{default:r},s=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(4));var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.host=e,this.vmId=null,this.vm=null,this.onceHandlers=[]}return i(t,[{key:"connect",value:function(t,e,n){var r=this;if(!(t=this.host.vmContext?this.host.vmContext.vmId+"."+t:t))throw new Error("'vmId' is required by connect()");return this.removeOrphan(t),this.vm=a.default.react.connect(t,this.host,o({setState:function(t){r.setState(t),r.notifyStateChange(t,n)}},e)),this.vmId=t,this.vm}},{key:"destroy",value:function(){this.vm.$destroy(),this.onceHandlers=[],this.vm=null}},{key:"setState",value:function(t){this.host.setState(t)}},{key:"notifyStateChange",value:function(t,e){if(this.onceHandlers.length>0){var n=this.onceHandlers.filter(function(e){return!e.propId||t.hasOwnProperty(e.propId)&&t[e.propId]!==e.value});this.onceHandlers=this.onceHandlers.filter(function(t){return!n.includes(t)}),n.forEach(function(e){return e.handler(t[e.propId])})}"function"==typeof e&&e(t)}},{key:"removeOrphan",value:function(t){a.default.react.getViewModels().filter(function(e){return e.$vmId===t}).forEach(function(t){return t.$destroy()})}},{key:"context",get:function(){var t=this;return{vmId:this.vmId,vm:this.vm,getState:function(e){return e?t.state.hasOwnProperty(e)?t.state[e]:void 0:t.state},setState:function(e){return t.setState(e)},dispatchState:function(e){return t.vm.$dispatch(e)},getPropAttributes:function(e){return s.toCamelCase(t.state[e+"__attr"]||{})},getPropValidations:function(e){return(t.state[e+"__validation"]||[]).map(function(t){return s.toCamelCase(t)})},once:function(e,n){return new Promise(function(r){return t.onceHandlers.push({propId:e,handler:function(t){return r(t)},value:n})})}}}},{key:"state",get:function(){return this.host.state}}]),t}();e.default=c},24:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function o(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var i=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.vmContext=e,this.propId=n}return r(t,[{key:"dispatch",value:function(t,e){this.vmContext.dispatchState(o({},this.propId,t),e)}},{key:"dispatchProp",value:function(t,e){void 0!==this.vmContext.getState(t)&&this.vmContext.setState(o({},t,e)),this.vmContext.dispatchState(o({},t,e))}},{key:"vm",get:function(){return this.vmContext.vm}},{key:"vmState",get:function(){return this.vmContext.getState()}},{key:"fullId",get:function(){return this.vmContext.vmId?this.vmContext.vmId+"."+this.propId:this.propId}},{key:"attrs",get:function(){return this.vmContext.getPropAttributes(this.propId)}},{key:"value",get:function(){return this.vmContext.getState(this.propId)},set:function(t){this.vmContext.setState(o({},this.propId,t))}}]),t}();e.default=i},25:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.VMContext=e.ContextTypes=void 0;var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=c(n(0)),u=c(n(2)),a=c(n(23)),s=c(n(75));function c(t){return t&&t.__esModule?t:{default:t}}var f=e.ContextTypes={vmContext:u.default.object,theme:u.default.object},l=e.VMContext=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.store=new a.default(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),o(e,[{key:"componentDidMount",value:function(){this.store.connect(this.props.vm,this.props.options,this.props.onStateChange)}},{key:"componentWillUnmount",value:function(){this.store.destroy()}},{key:"getChildContext",value:function(){return r({},this.context,{vmContext:this.store.context})}},{key:"render",value:function(){var t=this.props,e=t.children,n=t.placeholder;return this.state?e:n||null}},{key:"vmContext",get:function(){return this.context&&this.context.vmContext}}]),e}();l.contextTypes=f,l.childContextTypes=f,l.propTypes={vm:u.default.string,options:u.default.object,onStateChange:u.default.func},(0,s.default)(l,"d-vm-context")},26:function(t,e,n){"use strict";var r=function(t){};t.exports=function(t,e,n,o,i,u,a,s){if(r(e),!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var f=[n,o,i,u,a,s],l=0;(c=new Error(e.replace(/%s/g,function(){return f[l++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}}},27:function(t,e,n){"use strict";function r(t){return function(){return t}}var o=function(){};o.thatReturns=r,o.thatReturnsFalse=r(!1),o.thatReturnsTrue=r(!0),o.thatReturnsNull=r(null),o.thatReturnsThis=function(){return this},o.thatReturnsArgument=function(t){return t},t.exports=o},289:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Form=void 0;var r=n(81);e.default=r.Form,e.Form=r.Form},30:function(t,e,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},31:function(t,e,n){"use strict";var r=n(27),o=n(26),i=n(30);t.exports=function(){function t(t,e,n,r,u,a){a!==i&&o(!1,"Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types")}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=r,n.PropTypes=n,n}},4:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flexAuto=e.createEventEmitter=void 0;var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.deepEqual=function(t,e){return JSON.stringify(t)===JSON.stringify(e)},e.filterChildren=function(t,e){var n=[],r=u.default.Children.map(t,function(t){return t&&t.type&&e(t)?(n.push(t),null):t});return[n,r]},e.ifBoolElse=function(t,e){return"boolean"==typeof t?t:!!e},e.isIE11=a,e.mapChildren=function(t,e,n){var r=this;return u.default.Children.map(t,function(t){if(t)return t.type&&e(t)?n(t):t.props&&t.props.children?u.default.cloneElement(t,t.props,r.mapChildren(t.props.children,e,n)):t})},e.mergeProps=function(t){for(var e=Object.keys(t.type.propTypes||{}),n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.reduce(function(t,e){return Object.assign(t,e)},{}),u=Object.keys(i).filter(function(t){return"style"===t||"css"===t||e.includes(t)}).reduce(function(t,e){return Object.assign(t,function(t,e,n){e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n;return t}({},e,i[e]))},{});return Object.assign({},u,t.props)},e.resolveComponents=function(t,e){return Object.keys(t.componentTypes).map(function(n){return e[s(n)]||t.componentTypes[n]})},e.toCamelCase=s,e.toggleNavDrawer=function(t){var e=document.getElementsByTagName("nav");e.length>0&&(!1===t?e[0].classList.remove("open"):e[0].classList.toggle("open"))},e.toPixel=function(t){if(!t)return null;if("string"==typeof t&&t.endsWith("px"))return parseInt(t);var e=window.getComputedStyle(document.body,null)["font-size"];return e.endsWith("px")?parseInt(t)*parseInt(e):parseInt(t)};var o,i=n(0),u=(o=i)&&o.__esModule?o:{default:o};e.createEventEmitter=function(t){var e=[];return{emit:function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];e.forEach(function(t){return t.apply(void 0,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(n))})},subscribe:function(t){return!e.includes(t)&&e.push(t),function(){return e=e.filter(function(e){return e!==t})}}}};e.flexAuto=a()?"1 1 auto":"1";function a(){return window.navigator.userAgent.indexOf("Trident/")>0}function s(t){if("string"==typeof t)return t.substr(0,1).toLowerCase()+t.substr(1);if("object"===(void 0===t?"undefined":r(t))){var e={},n=!0,o=!1,i=void 0;try{for(var u,a=Object.keys(t)[Symbol.iterator]();!(n=(u=a.next()).done);n=!0){var c=u.value;e[s(c)]=t[c]}}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{if(o)throw i}}return e}return t}},73:function(t,e){t.exports=__WEBPACK_EXTERNAL_MODULE__73__},74:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=(i(n(0)),i(n(24)));function i(t){return t&&t.__esModule?t:{default:t}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=function(t){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n));return r.handleValidated=null,r.validations=r.vmContext.getPropValidations(n)||[],r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,o.default),r(e,[{key:"addValidation",value:function(t){var e;(e=this.validations).push.apply(e,function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(t))}},{key:"clear",value:function(){this.handleValidated&&this.handleValidated({valid:!0,messages:[]})}},{key:"getValidator",value:function(t){if("function"==typeof t.validate)return t.validate;var e="validate"+t.type,n=Object.getPrototypeOf(this);return n.hasOwnProperty(e)?n[e].bind(this,t):function(){return!0}}},{key:"onValidated",value:function(t){var e=this;return"function"==typeof t&&(this.handleValidated=t),function(){return e.handleValidated=null}}},{key:"validate",value:function(t){var e=this;return new Promise(function(n){t=void 0===t?e.value||null:t,Promise.all(e.validations.map(function(n){return e.runValidator(n,t)})).then(function(t){var r=t.map(function(t){return!1===t.isValid?t.message:null}).filter(function(t){return t}),o={inputId:e.propId,valid:0==r.length,messages:r};e.handleValidated&&e.handleValidated(o),n(o)})})}},{key:"runValidator",value:function(t,e){var n=this.getValidator(t)(e);return n instanceof Promise?n:new Promise(function(e){return e({isValid:n,message:t.message})})}},{key:"validatePattern",value:function(t,e){return!e||new RegExp(t.pattern).test(e)}},{key:"validateRange",value:function(t,e){var n=parseFloat(e),r=!("number"==typeof t.min&&n<t.min),o=!("number"==typeof t.max&&n>t.max);return r&&o}},{key:"validateRequired",value:function(t,e){return!(void 0===e||null==e||"string"==typeof e&&0==e.trim().length)}},{key:"validateServer",value:function(t,e){var n=this.propId+"__validation_"+t.id;this.vmContext.setState(u({},n,null));var r=this.vmContext.once(n,null);return this.vmContext.dispatchState(u({},this.propId,e),!0),r.then(function(e){return{isValid:e,message:t.message}})}},{key:"isRequired",get:function(){return this.validations.filter(function(t){return t.type&&"required"===t.type.toLowerCase()}).length>0}}]),e}();e.default=a},75:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default=function(t,e){var n=function(e){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.onStateChange=function(e){var n=t.helper.parseFunctionString(t.getAttribute("onStateChange"));"function"==typeof n&&n(e),t.dispatchEvent(new CustomEvent("onStateChange",e))},t.store=new i.default(t),t.helper=new u.default(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),o(n,[{key:"connectedCallback",value:function(){this.vmContextElem=this.parentElement.closest("d-vm-context"),this.vmContextElem&&(this.vmContext=this.vmContextElem.context);var e=this.getAttribute("vm"),n=this.getAttribute("options"),o=/{.*}/.exec(n)?JSON.parse(n):null;this.store.connect(e,o,this.onStateChange),this.props=r({},this.helper.getProps(this.attributes,t.propTypes),this.helper.getEvents(t.propTypes))}},{key:"disconnectedCallback",value:function(){this.store.destroy()}},{key:"setState",value:function(t){this.state=Object.assign(this.state||{},t),this.dispatchEvent(new CustomEvent("onLocalStateChange",t))}},{key:"context",get:function(){return r({_type:"custom"},this.store.context)}}]),n}(HTMLElement);window.customElements.get(e)||window.customElements.define(e,n)};var i=a(n(23)),u=a(n(14));function a(t){return t&&t.__esModule?t:{default:t}}},77:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r,o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(74),u=(r=i)&&r.__esModule?r:{default:r};function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.host=e,this.formId=this.props.id,this.validators=[],this.inputs=[],this.subForms=[],this.editMode=!1,this.preEditState=null}return o(t,[{key:"cancel",value:function(){this.host.vmContext.setState(this.preEditState),this.subForms.forEach(function(t){return t.cancel()}),this.validators.forEach(function(t){return t.clear()}),this.leaveEditMode()}},{key:"dispatchState",value:function(t,e){!0===e?this.host.vmContext.dispatchState(t):this.store(t),this.setChanged(t)}},{key:"enterEditMode",value:function(){this.editMode||(this.editMode=!0,this.preEditState=this.getPreEditState(this.host.vmContext.getState()),this.subForms.forEach(function(t){return t.enterEditMode()}))}},{key:"getContext",value:function(t,e){var n=this;return{formContext:e=e||{subForms:this.subForms,isChanged:function(){return n.changed},isPlainText:function(){return n.plainText},setChanged:function(t){return n.setChanged(t)},setPlainText:function(t){return n.plainText=t},submit:function(t){return n.handleSubmit(t)},cancel:function(){return n.cancel()}},vmContext:Object.assign({},t,{dispatchState:function(t,e){return n.dispatchState(t,e)},getValidator:function(t){return n.getValidator(t)},getPropAttributes:function(e){return n.getPropAttributes(t,e)}})}}},{key:"getPreEditState",value:function(t){var e=this;return Object.entries(t).filter(function(t){return e.inputs.some(function(e){return e.propId===t[0]})}).reduce(function(t,e){return Object.assign(t,s({},e[0],e[1]))},{})}},{key:"getPropAttributes",value:function(t,e){var n=this.host.formContext?this.host.formContext.isPlainText():this.props.plainText;return Object.assign({plainText:n},t.getPropAttributes(e))}},{key:"getValidator",value:function(t){var e=new u.default(t.vmContext,t.propId);return this.validators.push(e),this.inputs.push(t),e}},{key:"handleSubmit",value:function(t){var e=this,n=function(t,n){return e.submit(t,n)};return this.subForms.length>0?this.handleSubmitSubForms(t,n,this.props.onSubmitError):this.submitOnValidated(t,n).then(function(t){return t.valid||(e.props.onSubmitError&&e.props.onSubmitError(t),e.setInputFocus(t.failedIds[0])),t}).then(function(t){return t.valid})}},{key:"handleSubmitSubForms",value:function(t,e,n){var r=this,o={},i=function(t,e){return Object.assign(o,t?s({},t,e):e)};return Promise.all(this.subForms.map(function(t){return t.submitOnValidated(t.props.id,i)})).then(function(t){return t.reduce(function(t,e){return{failedForms:e.failedIds.length>0?[].concat(a(t.failedForms),[{formId:e.formId,failedIds:e.failedIds}]):t.failedForms,valid:t.valid&&e.valid,messages:[].concat(a(t.messages),a(e.messages))}},{valid:!0,messages:[],failedForms:[]})}).then(function(t){if(!t.valid){n&&n(t);var e=r.subForms.find(function(e){return e.props.id===t.failedForms[0].formId});e&&e.setInputFocus(t.failedForms[0].failedIds[0])}return t}).then(function(n){return n.valid&&e(t,o),n.valid})}},{key:"init",value:function(){this.host.formContext&&this.host.formContext.subForms.push(this),this.plainText=this.props.plainText}},{key:"leaveEditMode",value:function(){this.host.setState({changed:!1,edits:null}),this.subForms.forEach(function(t){return t.leaveEditMode()}),this.editMode=!1}},{key:"setChanged",value:function(t){this.changed||(this.changed=!0,this.props.onChanged&&this.props.onChanged(t)),this.host.formContext&&!this.host.formContext.isChanged()&&this.host.formContext.setChanged(t)}},{key:"setInputFocus",value:function(t){var e=this.inputs.filter(function(e){return e.propId===t}).shift();e&&e.dom&&e.dom.focus()}},{key:"store",value:function(t){this.host.setState({changed:!0,edits:Object.assign({},this.edits,t)})}},{key:"submit",value:function(t,e){var n=Object.assign({},this.preEditState,e);this.props.onSubmit&&!1===this.props.onSubmit(n)||this.host.vmContext.dispatchState(t?s({},t,n):e),this.leaveEditMode()}},{key:"submitOnValidated",value:function(t,e){var n=this.edits,r=!!n;return r||this.validators.some(function(t){return t.isRequired})?this.validate(this.formId).then(function(o){return o.valid&&r&&e(t,n),o}):Promise.resolve({formId:this.formId,valid:!0,messages:[],failedIds:[]})}},{key:"validate",value:function(t){return Promise.all(this.validators.map(function(t){return t.validate()})).then(function(e){return e.reduce(function(e,n){return{formId:t,valid:e.valid&&n.valid,messages:[].concat(a(e.messages),a(n.messages)),failedIds:n.valid?e.failedIds:[].concat(a(e.failedIds),[n.inputId])}},{valid:!0,messages:[],failedIds:[]})})}},{key:"edits",get:function(){return this.host.state.edits},set:function(t){this.host.setState({edits:t})}},{key:"changed",get:function(){return this.host.state.changed},set:function(t){this.host.setState({changed:t})}},{key:"plainText",get:function(){return this.host.state.plainText},set:function(t){this.host.setState({plainText:t})}},{key:"props",get:function(){return this.host.props||{}}}]),t}();e.default=c},81:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Form=e.FormContextTypes=void 0;var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},i=f(n(0)),u=f(n(2)),a=n(25),s=f(n(77)),c=f(n(83));function f(t){return t&&t.__esModule?t:{default:t}}var l=e.FormContextTypes=o({formContext:u.default.object},a.ContextTypes),p=e.Form=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var n=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={},n.formStore=new s.default(n),n}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i.default.Component),r(e,[{key:"formContext",get:function(){return this.context.formContext}},{key:"vmContext",get:function(){return this.context.vmContext}}]),r(e,[{key:"componentDidMount",value:function(){this.formStore.init()}},{key:"shouldComponentUpdate",value:function(t){return t.hasOwnProperty("plainText")&&t.plainText!==this.formStore.plainText&&(this.formStore.plainText=t.plainText),!1===t.plainText&&this.formStore.enterEditMode(),!0}},{key:"getChildContext",value:function(){var t=this.context,e=t.vmContext,n=t.formContext,r=function(t,e){var n={};for(var r in t)e.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}(t,["vmContext","formContext"]);return o({},r,this.formStore.getContext(e,n))}},{key:"render",value:function(){return this.formContext?this.props.children:i.default.createElement("form",{style:{width:"inherit"},onSubmit:function(t){return t.preventDefault()}},this.props.children)}}]),e}();p.contextTypes=l,p.childContextTypes=l,p.propTypes={id:u.default.string,plainText:u.default.bool,onSubmit:u.default.func,onSubmitError:u.default.func,onChanged:u.default.func},(0,c.default)(p,"d-form")},83:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.default=function(t,e){var n=function(e){function n(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.onStateChange=function(e){var n=t.helper.parseFunctionString(t.getAttribute("onStateChange"));"function"==typeof n&&n(e),t.dispatchEvent(new CustomEvent("onStateChange",e))},t.onSubmit=function(e){var n=t.helper.parseFunctionString(t.getAttribute("onSubmit"));"function"==typeof n&&n(e),t.dispatchEvent(new CustomEvent("onSubmit",e))},t.onSubmitError=function(e){var n=t.helper.parseFunctionString(t.getAttribute("onSubmitError"));"function"==typeof n&&n(e),t.dispatchEvent(new CustomEvent("onSubmitError",e))},t.onChanged=function(e){var n=t.helper.parseFunctionString(t.getAttribute("onChanged"));"function"==typeof n&&n(e),t.dispatchEvent(new CustomEvent("onChanged",e))},t.formStore=new i.default(t),t.helper=new u.default(t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(n,e),o(n,null,[{key:"observedAttributes",get:function(){return["plainText"]}}]),o(n,[{key:"connectedCallback",value:function(){this.vmContextElem=this.closest("d-vm-context"),this.vmContextElem&&(this.vmContext=this.vmContextElem.context),this.formElem=this.parentElement.closest("d-form"),this.formElem&&(this.formContext=this.formElem.context.formContext),this.props=r({},this.helper.getProps(this.attributes,t.propTypes),this.helper.getEvents(t.propTypes)),this.formStore.init()}},{key:"disconnectedCallback",value:function(){}},{key:"attributeChangedCallback",value:function(t,e,n){"plainText"===t&&n!==this.formStore.plainText&&(this.formStore.plainText=n),!1===n&&this.formStore.enterEditMode()}},{key:"setState",value:function(t){this.state=Object.assign(this.state||{},t),this.dispatchEvent(new CustomEvent("onStateChange",t))}},{key:"context",get:function(){return r({_type:"custom"},this.formStore.getContext(this.vmContext,this.formContext))}}]),n}(HTMLElement);window.customElements.get(e)||window.customElements.define(e,n,{extends:"form"})};var i=a(n(77)),u=a(n(14));function a(t){return t&&t.__esModule?t:{default:t}}}})});